CREATE OR REPLACE FUNCTION $DB_NAME$Views.SP_DCPUpsertContractGoalReward(
    pContractId INTEGER,
    pGoalId INTEGER,
    pRewardId INTEGER
)
RETURNS VOID AS $$
BEGIN

	-- Upsert goal
    INSERT INTO $DB_NAME$.Contract_Goal_Reward (ContractId, GoalId, RewardId)
    SELECT pContractId, pGoalId, pRewardId
    FROM $DB_NAME$Views.Lookup_Reward
    WHERE RewardId = pRewardId
    ON CONFLICT (ContractId, GoalId, RewardId) DO NOTHING
    ;
END
$$ LANGUAGE 'plpgsql';
