CREATE OR REPLACE FUNCTION $APP_NAME$Views.SP_DCPChangeContractStatus(
    pContractId INTEGER,
    pContractStatus CHAR(1)
) 
RETURNS VOID AS $$
BEGIN
	-- Set contract status
	UPDATE $APP_NAME$.Contract
	SET ContractStatus = pContractStatus
	WHERE ContractId = pContractId
	;
	
	IF(pContractStatus = 'P') THEN
	
		-- Generate user notifications
		PERFORM $APP_NAME$Views.SP_DCPUpsertUserNotification(NULL, 1003, pContractId); -- Pending contract to review
	END IF;
		
END
$$ LANGUAGE 'plpgsql';
